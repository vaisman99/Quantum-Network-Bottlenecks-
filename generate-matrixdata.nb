(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     91735,       2203]
NotebookOptionsPosition[     91382,       2189]
NotebookOutlinePosition[     91778,       2205]
CellTagsIndexPosition[     91735,       2202]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{
   RowBox[{"SetOptions", "[", 
    RowBox[{"$FrontEndSession", ",", 
     RowBox[{"NotebookAutoSave", "->", "True"}]}], "]"}], "\n", 
   RowBox[{"NotebookSave", "[", "]"}], "\[IndentingNewLine]", 
   RowBox[{"ClearAll", "[", "SaveToCell", "]"}], "\n", "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"SaveToCell", "::", "usage"}], "=", 
     RowBox[{
     "\"\<SaveToCell[variable] creates an input cell that reassigns the \
current value of variable.\\n\>\"", "<>", 
      "\"\<SaveToCell[variables, display] shows 'display' on the \
right-hand-side of the assignment.\>\""}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"SetAttributes", "[", 
    RowBox[{"SaveToCell", ",", "HoldFirst"}], "]"}], "\n", 
   RowBox[{
    RowBox[{"SaveToCell", "[", 
     RowBox[{"var_", ",", 
      RowBox[{"name", ":", 
       RowBox[{"Except", "[", 
        RowBox[{"_", "?", "OptionQ"}], "]"}], ":", "\"\<data\>\""}], ",", 
      RowBox[{"opt", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"data", "=", 
         RowBox[{"Compress", "[", "var", "]"}]}], ",", 
        RowBox[{"panel", "=", 
         RowBox[{"ToBoxes", "@", 
          RowBox[{"Tooltip", "[", 
           RowBox[{
            RowBox[{"Panel", "[", 
             RowBox[{"name", ",", 
              RowBox[{"FrameMargins", "->", "Small"}]}], "]"}], ",", 
            RowBox[{"DateString", "[", "]"}]}], "]"}]}]}]}], "}"}], ",", 
      RowBox[{"CellPrint", "@", 
       RowBox[{"Cell", "[", 
        RowBox[{
         RowBox[{"BoxData", "@", 
          RowBox[{"RowBox", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"MakeBoxes", "[", "var", "]"}], ",", "\"\<=\>\"", ",", 
             RowBox[{"InterpretationBox", "[", 
              RowBox[{"panel", ",", 
               RowBox[{"Uncompress", "[", "data", "]"}]}], "]"}], ",", 
             "\"\<;\>\""}], "}"}], "]"}]}], ",", "\"\<Input\>\"", ",", 
         RowBox[{"GeneratedCell", "->", "False"}], ",", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"prevent", " ", "deletion", " ", "by", " ", "Cell"}], ">", 
           
           RowBox[{"Delete", " ", "All", " ", 
            RowBox[{"Output", ":"}]}]}], "*)"}], 
         RowBox[{"CellLabel", "->", "\"\<(saved)\>\""}], ",", "opt", ",", 
         RowBox[{"CellLabelAutoDelete", "->", "False"}]}], "]"}]}]}], "]"}]}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"testpath", "[", "v_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"neighs", ",", "i", ",", "intersections"}], "}"}], ",", 
      RowBox[{"(*", 
       RowBox[{"'", 
        RowBox[{"neighs", "'"}], " ", "will", " ", "hold", " ", "a", " ", 
        "modified", " ", "version", " ", 
        RowBox[{"of", "'"}], 
        RowBox[{"neighlist", "'"}], " ", "with", " ", "certain", " ", 
        "entries", " ", 
        RowBox[{"removed", ".", "We"}], " ", "are", " ", "removing", " ", 
        "the", " ", "entries", " ", "corresponding", " ", "to", " ", "the", 
        " ", "first", " ", "and", " ", "last", " ", "elements", " ", 
        RowBox[{"of", "'"}], 
        RowBox[{"v", "'"}], " ", "as", " ", "found", " ", 
        RowBox[{"in", "'"}], 
        RowBox[{
         RowBox[{"nodlist", "'"}], ".", 
         RowBox[{"Position", "[", 
          RowBox[{"nodlist", ",", 
           RowBox[{"v", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], " ", "finds", " ", 
        "where", " ", 
        RowBox[{"v", "'"}], "s", " ", "first", " ", "element", " ", "appears",
         " ", "in", " ", 
        RowBox[{"nodlist", ".", 
         RowBox[{"Position", "[", 
          RowBox[{"nodlist", ",", 
           RowBox[{"v", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}]}], " ", "finds", " ", 
        "where", " ", 
        RowBox[{"v", "'"}], "s", " ", "last", " ", "element", " ", "appears", 
        " ", "in", " ", 
        RowBox[{"nodlist", ".", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Position", "[", 
           RowBox[{"nodlist", ",", 
            RowBox[{"v", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], " ", "and", 
        " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{"nodlist", ",", 
           RowBox[{"v", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}], "]"}], " ", "give", 
        " ", "us", " ", "the", " ", "indices", " ", "of", " ", "these", " ", 
        RowBox[{"positions", ".", "We"}], " ", "then", " ", "use", " ", 
        RowBox[{"Delete", "[", "]"}], " ", "to", " ", "remove", " ", "the", 
        " ", "corresponding", " ", "entries", " ", 
        RowBox[{"from", "'"}], 
        RowBox[{
         RowBox[{"neighlist", "'"}], "."}]}], "*)"}], 
      RowBox[{
       RowBox[{"neighs", "=", 
        RowBox[{"Delete", "[", 
         RowBox[{"neighlist", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"Position", "[", 
              RowBox[{"nodlist", ",", 
               RowBox[{"v", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
            RowBox[{"Flatten", "[", 
             RowBox[{"Position", "[", 
              RowBox[{"nodlist", ",", 
               RowBox[{"v", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}], "]"}]}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"'", 
         RowBox[{"intersections", "'"}], " ", "will", " ", "store", " ", 
         "the", " ", "intersection", " ", "counts", " ", 
         RowBox[{"between", "'"}], 
         RowBox[{"v", "'"}], " ", "and", " ", "each", " ", "sublist", " ", 
         RowBox[{"in", "'"}], 
         RowBox[{
          RowBox[{"neighs", "'"}], "."}]}], "*)"}], 
       RowBox[{"intersections", "=", 
        RowBox[{"List", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"Loop", " ", "over", " ", "each", " ", "element", " ", 
           RowBox[{"in", "'"}], 
           RowBox[{"neighs", "'"}]}], ":", 
          RowBox[{"For", " ", "each", " ", "sublist", " ", 
           RowBox[{"(", 
            RowBox[{"neighs", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ")"}]}]}], ",", 
         RowBox[{"we", " ", "compute", " ", "the", " ", "intersection", " ", 
          RowBox[{"with", "'"}], 
          RowBox[{
           RowBox[{"v", "'"}], ".", 
           RowBox[{"Intersection", "[", 
            RowBox[{"v", ",", 
             RowBox[{"neighs", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], " ", "returns", " ", 
          "the", " ", "elements", " ", "common", " ", "to", " ", 
          RowBox[{"both", ".", 
           RowBox[{"Length", "[", 
            RowBox[{"Intersection", "[", 
             RowBox[{"v", ",", 
              RowBox[{"neighs", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}]}], " ", "is", 
          " ", "the", " ", "number", " ", "of", " ", "common", " ", 
          RowBox[{"elements", ".", "AppendTo"}], " ", "adds", " ", "these", 
          " ", "intersection", " ", "counts", " ", 
          RowBox[{"to", "'"}], 
          RowBox[{
           RowBox[{"intersections", "'"}], "."}]}]}], "*)"}], 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<=", 
          RowBox[{"Length", "[", "neighs", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"intersections", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"Intersection", "[", 
             RowBox[{"v", ",", 
              RowBox[{"neighs", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}]}], "]"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{
          "Check", " ", "if", " ", "all", " ", "intersection", " ", "counts", 
           " ", "are", " ", 
           RowBox[{"even", ":", 
            RowBox[{
             RowBox[{"EvenQ", "[", "intersections", "]"}], " ", "returns", 
             " ", 
             RowBox[{"True", "/", "False"}], " ", "for", " ", "each", " ", 
             RowBox[{"element", ".", 
              RowBox[{"Boole", "[", "...", "]"}]}], " ", "converts", " ", 
             "True"}]}]}], "->", 
          RowBox[{
           RowBox[{"1", " ", "and", " ", "False"}], "->", 
           RowBox[{"0.", " ", 
            RowBox[{"Times", "@@", 
             RowBox[{"Boole", "[", 
              RowBox[{"EvenQ", "[", "intersections", "]"}], "]"}]}], " ", 
            "multiplies", " ", "all", " ", "the", " ", "booleans", " ", 
            RowBox[{"together", ".", "If"}], " ", "all", " ", "are", " ", 
            "True", " ", 
            RowBox[{"(", 
             RowBox[{"all", " ", "even"}], ")"}]}]}]}], ",", 
         RowBox[{
         "the", " ", "product", " ", "is", " ", "1.", " ", "If", " ", "any", 
          " ", "is", " ", "False"}], ",", 
         RowBox[{
         "the", " ", "product", " ", "is", " ", "0.", " ", "If", " ", "this", 
          " ", "condition", " ", "is", " ", "met"}], ",", 
         RowBox[{"return", " ", "1"}], ",", 
         RowBox[{
         "otherwise", " ", "return", " ", "0.", " ", "The", " ", "comment", 
          " ", "suggests", " ", "that", " ", "this", " ", "is", " ", "a", " ",
           "test", " ", "for", " ", "whether", " ", "the", " ", "given", " ", 
          
          RowBox[{"path", "'"}], 
          RowBox[{"v", "'"}], " ", "results", " ", "in", " ", "a", " ", 
          "\"\<bottleneck\>\"", " ", "or", " ", "not"}], ",", 
         RowBox[{
         "based", " ", "on", " ", "the", " ", "parity", " ", "of", " ", 
          "these", " ", "intersection", " ", 
          RowBox[{"counts", "."}]}]}], "*)"}], 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Times", "@@", 
           RowBox[{"Boole", "[", 
            RowBox[{"EvenQ", "[", "intersections", "]"}], "]"}]}], "==", 
          "1"}], ",", "1", ",", "0"}], "]"}]}]}], "]"}]}], " ", 
   RowBox[{"(*", 
    RowBox[{"END", " ", "of", " ", "testpath", " ", "function"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "d", " ", "sets", " ", "the", " ", "dimension", " ", "of", " ", "the", 
      " ", "grid", " ", 
      RowBox[{"graph", ".", "For"}], " ", "example"}], ",", 
     RowBox[{"d", "=", 
      RowBox[{"6", " ", "creates", " ", "a", " ", "6", "x6", " ", 
       RowBox[{"grid", "."}]}]}]}], "*)"}], 
   RowBox[{
    RowBox[{"d", "=", "6"}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "Create", " ", "a", " ", "grid", " ", "graph", " ", "of", " ", 
       "dimension", " ", "d", " ", "x", " ", 
       RowBox[{"d", ".", 
        RowBox[{"GridGraph", "[", 
         RowBox[{"{", 
          RowBox[{"d", ",", "d"}], "}"}], "]"}]}], " ", "generates", " ", "a",
        " ", "graph", " ", "with", " ", 
       RowBox[{"d", "^", "2"}], " ", "vertices", " ", "arranged", " ", "in", 
       " ", "a", " ", "d"}], "-", "by", "-", 
      RowBox[{"d", " ", "grid"}]}], ",", 
     RowBox[{
      RowBox[{
      "and", " ", "edges", " ", "connecting", " ", "each", " ", "vertex", " ",
        "to", " ", "its", " ", "immediate", " ", "neighbors", " ", "in", " ", 
       "the", " ", 
       RowBox[{"grid", ".", "VertexLabels"}]}], "->", 
      RowBox[{
      "\"\<Name\>\"", " ", "ensures", " ", "that", " ", "each", " ", "vertex",
        " ", "is", " ", "labeled", " ", "by", " ", "its", " ", "index", " ", 
       RowBox[{"number", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"graph", "=", 
     RowBox[{"GridGraph", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"d", ",", "d"}], "}"}], ",", 
       RowBox[{"VertexLabels", "->", "\"\<Name\>\""}]}], "]"}]}], ";"}], "\n",
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"'", 
       RowBox[{"cases", "'"}], " ", "represents", " ", "all", " ", "possible",
        " ", "combinations", " ", "of", " ", "4", " ", "distinct", " ", 
       "nodes", " ", "from", " ", "the", " ", 
       RowBox[{"graph", ".", 
        RowBox[{"Let", "'"}]}], "s", " ", "break", " ", "down", " ", "the", 
       " ", 
       RowBox[{"steps", ":", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"1", ",", 
           RowBox[{"d", "^", "2"}]}], "]"}], " ", "creates", " ", "a", " ", 
         "list", " ", "of", " ", "all", " ", "node", " ", "labels", " ", 
         "from", " ", "1", " ", "to", " ", 
         RowBox[{"d", "^", "2."}], " ", "For", " ", "d"}]}]}], "=", "6"}], 
     ",", 
     RowBox[{
      RowBox[{
       RowBox[{"that", "'"}], "s", " ", "1", " ", "to", " ", "36.", " ", 
       RowBox[{"Subsets", "[", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"1", ",", 
           RowBox[{"d", "^", "2"}]}], "]"}], ",", 
         RowBox[{"{", "2", "}"}]}], "]"}], " ", "gives", " ", "all", " ", 
       "2"}], "-", 
      RowBox[{"element", " ", "subsets", " ", "of", " ", "these", " ", 
       RowBox[{"nodes", ".", "For"}], " ", "example"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "3"}], "}"}], ",", "..."}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"etc", ".", 
        RowBox[{"Subsets", "[", 
         RowBox[{"...", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], " ", "applied", " ", "again", 
       " ", "takes", " ", "all", " ", "possible", " ", "2"}], "-", 
      RowBox[{"element", " ", "subsets", " ", "of", " ", "these", " ", "2"}], 
      "-", 
      RowBox[{"element", " ", 
       RowBox[{"subsets", ".", "Essentially"}]}]}], ",", 
     RowBox[{"this", " ", "yields", " ", "pairs", " ", "of", " ", "pairs"}], 
     ",", 
     RowBox[{"i", ".", "e", "."}], ",", 
     RowBox[{
      RowBox[{"sets", " ", "of", " ", "two", " ", "distinct", " ", "2"}], "-", 
      RowBox[{"element", " ", 
       RowBox[{"subsets", ".", "For"}], " ", 
       RowBox[{"example", ":", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "4"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"5", ",", "6"}], "}"}]}], "}"}], ",", "..."}], "}"}], 
         " ", 
         RowBox[{"Join", "@@@", "merges"}], " ", "these", " ", "pairs", " ", 
         "of", " ", "pairs", " ", "into", " ", "simple", " ", "lists", " ", 
         "of", " ", "length", " ", "4.", " ", "For", " ", "example"}]}]}]}], 
     ",", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "4"}], "}"}]}], "}"}], "}"}], " ", "becomes", 
       " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], ".", "The"}], 
       " ", "Select", " ", "function", " ", "with", " ", "the", " ", 
       "condition", " ", 
       RowBox[{"Length", "[", 
        RowBox[{"Union", "[", "#", "]"}], "]"}]}], "==", 
      RowBox[{
      "4", " ", "ensures", " ", "that", " ", "all", " ", "4", " ", "elements",
        " ", "in", " ", "each", " ", "resulting", " ", "list", " ", "are", 
       " ", 
       RowBox[{"distinct", ".", "This"}], " ", "filters", " ", "out", " ", 
       "any", " ", "cases", " ", "where", " ", "the", " ", "two", " ", 
       "subsets", " ", "had", " ", "a", " ", "node", " ", "in", " ", 
       "common"}]}], ",", 
     RowBox[{"e", ".", "g", "."}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "3"}], "}"}]}], "}"}], " ", "would", " ", "yield", 
      " ", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "2", ",", "3"}], "}"}]}], ",", 
     RowBox[{
     "which", " ", "after", " ", "taking", " ", "the", " ", "Union", " ", 
      "would", " ", "have", " ", "fewer", " ", "than", " ", "4", " ", 
      "distinct", " ", 
      RowBox[{"elements", ".", "In"}], " ", "short"}], ",", 
     RowBox[{"'", 
      RowBox[{"cases", "'"}], " ", "is", " ", "all", " ", "possible", " ", 
      "unique", " ", "combinations", " ", "of", " ", "exactly", " ", "4", " ",
       "distinct", " ", "nodes", " ", "chosen", " ", "from", " ", "the", " ", 
      
      RowBox[{"d", "^", "2"}], " ", 
      RowBox[{"nodes", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cases", "=", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"Join", "@@@", 
        RowBox[{"Subsets", "[", 
         RowBox[{
          RowBox[{"Subsets", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"1", ",", 
              RowBox[{"d", "^", "2"}]}], "]"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"Union", "[", "#", "]"}], "]"}], "==", "4"}], "&"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"'", 
      RowBox[{"cases", "'"}], " ", "can", " ", "now", " ", "be", " ", "used", 
      " ", "for", " ", "further", " ", "analysis"}], ",", 
     RowBox[{"such", " ", "as", " ", "checking", " ", "paths"}], ",", 
     "bottlenecks", ",", 
     RowBox[{
      RowBox[{
      "or", " ", "other", " ", "properties", " ", "within", " ", "the", " ", 
       "graph", " ", "based", " ", "on", " ", "these", " ", "4"}], "-", 
      RowBox[{"node", " ", 
       RowBox[{"combinations", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "This", " ", "code", " ", "uses", " ", "parallelization", " ", "to", " ",
       "process", " ", "a", " ", "set", " ", "of", " ", "node", " ", 
      "quadruples", " ", 
      RowBox[{"(", "\"\<cases\>\"", ")"}], " ", "on", " ", "a", " ", "grid", 
      " ", 
      RowBox[{"graph", ".", "For"}], " ", "each", " ", "quadruple", " ", "of",
       " ", "nodes"}], ",", 
     RowBox[{
      RowBox[{
      "it", " ", "identifies", " ", "paths", " ", "between", " ", "pairs", 
       " ", "of", " ", "these", " ", "nodes", " ", "and", " ", "checks", " ", 
       "whether", " ", "these", " ", "paths", " ", "are", " ", 
       "\"\<bottleneck-free\>\"", " ", "as", " ", "determined", " ", "by", 
       " ", "the", " ", 
       RowBox[{"testpath", "[", "]"}], " ", 
       RowBox[{"function", ".", "The"}], " ", "first", " ", "block", " ", 
       RowBox[{"(", "`poss0`", ")"}], " ", "searches", " ", "for", " ", 
       "paths", " ", "of", " ", "length", " ", "up", " ", "to", " ", "the", 
       " ", "shortest", " ", "path", " ", "length", " ", "plus", " ", "0.", 
       " ", "The", " ", "second", " ", "block", " ", 
       RowBox[{"(", "`poss2`", ")"}], " ", "searches", " ", "up", " ", "to", 
       " ", "the", " ", "shortest", " ", "path", " ", "length", " ", "plus", 
       " ", "2.", " ", "The", " ", "difference", " ", "in", " ", "path", " ", 
       "length", " ", "constraints", " ", "can", " ", "reveal", " ", "how", 
       " ", "allowing", " ", "longer", " ", "paths", " ", "affects", " ", 
       "the", " ", "availability", " ", "of", " ", "bottleneck"}], "-", 
      RowBox[{"free", " ", 
       RowBox[{"paths", "."}]}]}]}], "*)"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "d", " ", "and", " ", "graph", " ", "would", " ", "have", " ", "been", 
      " ", "defined", " ", "previously"}], ",", 
     RowBox[{"along", " ", 
      RowBox[{"with", "'"}], 
      RowBox[{"cases", "'"}], " ", "which", " ", "is", " ", "a", " ", "list", 
      " ", "of", " ", "quadruples", " ", "of", " ", "nodes", " ", "to", " ", 
      RowBox[{"test", ".", "Here"}], " ", "we", " ", "assume", " ", "these", 
      " ", "are", " ", "already", " ", "available", " ", "in", " ", "the", 
      " ", 
      RowBox[{"environment", "."}]}]}], "*)"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"--", 
      RowBox[{"-", "First"}]}], " ", 
     RowBox[{"Computation", ":", 
      RowBox[{
       RowBox[{"poss0", "--"}], "-"}]}]}], "*)"}], 
   RowBox[{
    RowBox[{"poss0", "=", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"nodlist", "=", "i"}], ";", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"'", 
           RowBox[{"i", "'"}], " ", 
           RowBox[{"from", "'"}], 
           RowBox[{"cases", "'"}], " ", "is", " ", "a", " ", "quadruple", " ",
            "of", " ", "distinct", " ", "nodes"}], ";", 
          RowBox[{"assign", " ", "it", " ", "to", " ", 
           RowBox[{"nodlist", "."}]}]}], "*)"}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{
           "Initialize", " ", "variables", " ", "for", " ", "the", " ", 
            RowBox[{"loop", ":", 
             RowBox[{
             "i", " ", "and", " ", "j", " ", "serve", " ", "as", " ", 
              "indices"}]}]}], ";", 
           RowBox[{
           "lenshortpaths", " ", "stores", " ", "shortest", " ", "path", " ", 
            "lengths"}], ";", "\[IndentingNewLine]", 
           RowBox[{
           "allpaths", " ", "will", " ", "store", " ", "all", " ", "found", 
            " ", "paths"}], ";", 
           RowBox[{
           "neighlist", " ", "stores", " ", "neighboring", " ", "nodes", " ", 
            "of", " ", "endpoints"}], ";", "\[IndentingNewLine]", 
           RowBox[{
           "validpaths", " ", "will", " ", "store", " ", "only", " ", "those",
             " ", "paths", " ", "that", " ", "are", " ", "simple", " ", 
            RowBox[{"(", 
             RowBox[{
             "isomorphic", " ", "to", " ", "a", " ", "simple", " ", 
              "PathGraph"}], ")"}]}]}], ",", 
          RowBox[{
          "and", " ", "numvalidpaths", " ", "counts", " ", "how", " ", "many",
            " ", "valid", " ", "paths", " ", "we", " ", 
           RowBox[{"find", "."}]}]}], "*)"}], 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"i", "=", "1"}], ";", 
           RowBox[{"j", "=", "0"}], ";", 
           RowBox[{"lenshortpaths", "=", 
            RowBox[{"List", "[", "]"}]}], ";", 
           RowBox[{"allpaths", "=", 
            RowBox[{"List", "[", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"neighlist", "=", 
            RowBox[{"List", "[", "]"}]}], ";", 
           RowBox[{"validpaths", "=", 
            RowBox[{"List", "[", "]"}]}], ";", 
           RowBox[{"numvalidpaths", "=", 
            RowBox[{"List", "[", "]"}]}]}], ",", 
          RowBox[{"i", "<=", "3"}], ",", 
          RowBox[{"i", "=", 
           RowBox[{"i", "+", "2"}]}], ",", 
          RowBox[{
           RowBox[{"j", "=", 
            RowBox[{"j", "+", "1"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
             "Find", " ", "the", " ", "shortest", " ", "path", " ", "between",
               " ", 
              RowBox[{"nodlist", "[", 
               RowBox[{"[", "i", "]"}], "]"}], " ", "and", " ", 
              RowBox[{"nodlist", "[", 
               RowBox[{"[", 
                RowBox[{"i", "+", "1"}], "]"}], "]"}], " ", "in", " ", "the", 
              " ", 
              RowBox[{"graph", ".", "Store"}], " ", "its", " ", "length", " ",
               "in", " ", 
              RowBox[{"lenshortpaths", ".", "Here"}]}], ",", 
             RowBox[{
             "the", " ", "set", " ", "of", " ", "nodes", " ", "in", " ", 
              "nodlist", " ", "represents", " ", "some", " ", "constraint", 
              " ", "on", " ", "the", " ", "graph"}], ",", 
             RowBox[{
             "possibly", " ", "to", " ", "remove", " ", "them", " ", "from", 
              " ", "the", " ", 
              RowBox[{"search", "."}]}]}], "*)"}], 
           RowBox[{"AppendTo", "[", 
            RowBox[{"lenshortpaths", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"FindShortestPath", "[", 
               RowBox[{"graph", ",", 
                RowBox[{"nodlist", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{"nodlist", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}], "]"}]}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"allpaths", ":", 
              RowBox[{"Find", " ", "all", " ", "paths", " ", "between", " ", 
               RowBox[{"nodlist", "[", 
                RowBox[{"[", "i", "]"}], "]"}], " ", "and", " ", 
               RowBox[{"nodlist", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "+", "1"}], "]"}], "]"}], " ", "up", " ", "to", 
               " ", "length"}]}], "=", 
             RowBox[{
              RowBox[{"shortest", " ", "path", " ", "length"}], "+", 
              RowBox[{
              "0.", " ", "We", " ", "remove", " ", "all", " ", "other", " ", 
               "nodes", " ", "in", " ", "nodlist", " ", "from", " ", "the", 
               " ", "graph", " ", "to", " ", "enforce", " ", "certain", " ", 
               RowBox[{"constraints", "."}]}]}]}], "*)"}], 
           RowBox[{"AppendTo", "[", 
            RowBox[{"allpaths", ",", 
             RowBox[{"FindPath", "[", 
              RowBox[{
               RowBox[{"VertexDelete", "[", 
                RowBox[{"graph", ",", 
                 RowBox[{"Complement", "[", 
                  RowBox[{"nodlist", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"nodlist", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"nodlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
                 "]"}], ",", 
               RowBox[{"nodlist", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"nodlist", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"lenshortpaths", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "+", "0"}], ",", "All"}], 
              "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Now", " ", "filter", " ", "these", " ", 
              RowBox[{"paths", ".", "We"}], " ", "check", " ", "each", " ", 
              RowBox[{"path", "'"}], 
              RowBox[{
               RowBox[{"allpaths", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "k"}], "]"}], "]"}], "'"}], " ", "to", " ",
               "ensure", " ", "it", " ", "forms", " ", "a", " ", "simple", 
              " ", "path", " ", 
              RowBox[{"(", 
               RowBox[{
               "no", " ", "extra", " ", "edges", " ", "or", " ", 
                "complexity"}], ")"}], " ", "by", " ", "comparing", " ", "it",
               " ", "with", " ", "a", " ", "PathGraph", " ", "constructed", 
              " ", "from", " ", "its", " ", 
              RowBox[{"vertices", ".", "If"}], " ", "they", " ", "match", " ", 
              RowBox[{"(", "IsomorphicGraphQ", ")"}]}], ",", 
             RowBox[{
             "we", " ", "have", " ", "a", " ", "valid", " ", "simple", " ", 
              RowBox[{"path", "."}]}]}], "*)"}], 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"k", "=", "1"}], ";", 
              RowBox[{"l", "=", "0"}]}], ",", 
             RowBox[{"k", "<=", 
              RowBox[{"Length", "[", 
               RowBox[{"allpaths", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ",", 
             RowBox[{"k", "++"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"IsomorphicGraphQ", "[", 
                RowBox[{
                 RowBox[{"Subgraph", "[", 
                  RowBox[{"graph", ",", 
                   RowBox[{"allpaths", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "k"}], "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{"PathGraph", "[", 
                  RowBox[{"allpaths", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "k"}], "]"}], "]"}], "]"}]}], "]"}], 
               ",", 
               RowBox[{
                RowBox[{"AppendTo", "[", 
                 RowBox[{"validpaths", ",", 
                  RowBox[{"allpaths", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "k"}], "]"}], "]"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"l", "=", 
                 RowBox[{"l", "+", "1"}]}]}]}], "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"numvalidpaths", ",", "l"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "Record", " ", "the", " ", "neighbors", " ", "of", " ", "the", 
             " ", "endpoints", " ", 
             RowBox[{"(", 
              RowBox[{
              "excluding", " ", "the", " ", "endpoints", " ", "themselves"}], 
              ")"}], " ", "to", " ", "form", " ", 
             RowBox[{"neighlist", ".", "These"}], " ", "might", " ", "be", 
             " ", "used", " ", "by", " ", "testpath", " ", "or", " ", "other",
              " ", 
             RowBox[{"logic", "."}]}], "*)"}], 
           RowBox[{"AppendTo", "[", 
            RowBox[{"neighlist", ",", 
             RowBox[{"Complement", "[", 
              RowBox[{
               RowBox[{"VertexList", "[", 
                RowBox[{"NeighborhoodGraph", "[", 
                 RowBox[{"graph", ",", 
                  RowBox[{"nodlist", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"nodlist", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "}"}]}], "]"}]}], "]"}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"neighlist", ",", 
             RowBox[{"Complement", "[", 
              RowBox[{
               RowBox[{"VertexList", "[", 
                RowBox[{"NeighborhoodGraph", "[", 
                 RowBox[{"graph", ",", 
                  RowBox[{"nodlist", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}], "]"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"nodlist", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}], "}"}]}], "]"}]}], 
            "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "After", " ", "collecting", " ", "all", " ", "valid", " ", "paths", 
           " ", "for", " ", "this", " ", "quadruple", " ", "of", " ", 
           "nodes"}], ",", 
          RowBox[{
           RowBox[{
           "we", " ", "want", " ", "to", " ", "see", " ", "if", " ", "any", 
            " ", "of", " ", "them", " ", "avoids", " ", "a", " ", 
            RowBox[{"bottleneck", ".", 
             RowBox[{"testpath", "[", "]"}]}], " ", "returns", " ", "1", " ", 
            "if", " ", "bottleneck"}], "-", "free"}], ",", 
          RowBox[{
           RowBox[{"else", " ", "0.", " ", "occ"}], "=", 
           RowBox[{
           "2", " ", "is", " ", "a", " ", "temporary", " ", "state", " ", 
            "meaning", " ", "\"\<not decided yet.\>\"", " ", "We", " ", 
            "iterate", " ", "through", " ", "validpathsx", " ", 
            RowBox[{"(", 
             RowBox[{"a", " ", "copy", " ", "of", " ", "validpaths"}], 
             ")"}]}]}], ",", 
          RowBox[{"testing", " ", "each", " ", 
           RowBox[{"path", ":", 
            RowBox[{
             RowBox[{"-", "If"}], " ", "testpath", " ", "returns", " ", 
             "1"}]}]}], ",", 
          RowBox[{
          "occ", " ", "is", " ", "set", " ", "to", " ", "1", " ", "and", " ", 
           "we", " ", 
           RowBox[{"stop", ".", 
            RowBox[{"-", "If"}]}], " ", "testpath", " ", "returns", " ", 
           "0"}], ",", 
          RowBox[{
          "we", " ", "remove", " ", "that", " ", "path", " ", "and", " ", 
           "try", " ", "the", " ", "next", " ", 
           RowBox[{"one", ".", 
            RowBox[{"-", "If"}]}], " ", "we", " ", "run", " ", "out", " ", 
           "of", " ", "paths"}], ",", 
          RowBox[{"occ", "=", "0."}]}], "*)"}], 
        RowBox[{"occ", "=", "2"}], ";", "\[IndentingNewLine]", 
        RowBox[{"validpathsx", "=", "validpaths"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"occ", "==", "2"}], ",", 
            RowBox[{
             RowBox[{"Length", "[", "validpathsx", "]"}], ">=", "0"}]}], 
           "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "validpathsx", "]"}], ">", "0"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"testpath", "[", 
                RowBox[{"validpathsx", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "==", "1"}], ",", 
              RowBox[{"occ", "=", "1"}], ",", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"found", " ", "a", " ", "bottleneck"}], "-", 
                RowBox[{"free", " ", "path"}]}], "*)"}], 
              RowBox[{"validpathsx", "=", 
               RowBox[{"Delete", "[", 
                RowBox[{"validpathsx", ",", "1"}], "]"}]}]}], " ", 
             RowBox[{"(*", 
              RowBox[{
              "remove", " ", "the", " ", "tested", " ", "path", " ", "and", 
               " ", "try", " ", "next"}], "*)"}], "]"}], ",", 
            RowBox[{"occ", "=", "0"}]}], " ", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
             "no", " ", "paths", " ", "left", " ", "means", " ", "no", " ", 
              "bottleneck"}], "-", 
             RowBox[{"free", " ", "path", " ", "found"}]}], "*)"}], "]"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{
           "Return", " ", "the", " ", "nodlist", " ", "and", " ", "occ", " ", 
            "for", " ", "this", " ", "set", " ", "of", " ", 
            RowBox[{"nodes", ".", "occ"}]}], "=", 
           RowBox[{"1", " ", "means", " ", "success"}]}], ",", 
          RowBox[{"occ", "=", 
           RowBox[{"0", " ", "means", " ", 
            RowBox[{"failure", "."}]}]}]}], "*)"}], 
        RowBox[{"{", 
         RowBox[{"nodlist", ",", "occ"}], "}"}]}], ",", 
       RowBox[{"(*", 
        RowBox[{"Iterate", " ", "over", " ", "all", " ", "quadruples", " ", 
         RowBox[{"in", "'"}], 
         RowBox[{"cases", "'"}], " ", "in", " ", 
         RowBox[{"parallel", "."}]}], "*)"}], 
       RowBox[{"{", 
        RowBox[{"i", ",", "cases"}], "}"}], ",", 
       RowBox[{"Method", "->", "\"\<CoarsestGrained\>\""}]}], "]"}]}], ";"}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Extract", " ", "all", " ", "sets", " ", "of", " ", "nodes", " ", 
      RowBox[{"(", "nodlist", ")"}], " ", "that", " ", "produced", " ", 
      "occ"}], "=", 
     RowBox[{"1", " ", "from", " ", 
      RowBox[{"poss0", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"six0", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"poss0", ",", 
         RowBox[{"{", 
          RowBox[{"_", ",", "1"}], "}"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Save", " ", "six0", " ", "to", " ", "the", " ", "notebook", " ", "in", 
      " ", "a", " ", "persistent", " ", 
      RowBox[{"way", ".", "Deletable"}]}], "->", 
     RowBox[{
     "False", " ", "prevents", " ", "the", " ", "cell", " ", "from", " ", 
      "being", " ", "deleted", " ", "when", " ", "clearing", " ", 
      RowBox[{"output", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"SaveToCell", "[", 
    RowBox[{"six0", ",", 
     RowBox[{"Deletable", "->", "False"}]}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"--", 
       RowBox[{"-", "Second"}]}], " ", 
      RowBox[{"Computation", ":", 
       RowBox[{
        RowBox[{"poss2", "--"}], "-", 
        RowBox[{
        "This", " ", "is", " ", "almost", " ", "identical", " ", "to", " ", 
         "the", " ", "first", " ", "computation"}]}]}]}], ",", 
     RowBox[{
      RowBox[{
      "but", " ", "now", " ", "we", " ", "allow", " ", "paths", " ", "of", 
       " ", "length", " ", "up", " ", "to", " ", "shortest", " ", "path", " ",
        "length"}], "+", 
      RowBox[{"2", " ", "instead", " ", "of"}], "+", "0."}]}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"poss2", "=", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"nodlist", "=", "i"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"i", "=", "1"}], ";", 
           RowBox[{"j", "=", "0"}], ";", 
           RowBox[{"lenshortpaths", "=", 
            RowBox[{"List", "[", "]"}]}], ";", 
           RowBox[{"allpaths", "=", 
            RowBox[{"List", "[", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"neighlist", "=", 
            RowBox[{"List", "[", "]"}]}], ";", 
           RowBox[{"validpaths", "=", 
            RowBox[{"List", "[", "]"}]}], ";", 
           RowBox[{"numvalidpaths", "=", 
            RowBox[{"List", "[", "]"}]}]}], ",", 
          RowBox[{"i", "<=", "3"}], ",", 
          RowBox[{"i", "=", 
           RowBox[{"i", "+", "2"}]}], ",", 
          RowBox[{
           RowBox[{"j", "=", 
            RowBox[{"j", "+", "1"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"lenshortpaths", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"FindShortestPath", "[", 
               RowBox[{"graph", ",", 
                RowBox[{"nodlist", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{"nodlist", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}], "]"}]}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"Key", " ", 
             RowBox[{"difference", ":", 
              RowBox[{
               RowBox[{"lenshortpaths", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "+", 
               RowBox[{"2", " ", "instead", " ", "of"}], "+", "0"}]}]}], 
            "*)"}], 
           RowBox[{"AppendTo", "[", 
            RowBox[{"allpaths", ",", 
             RowBox[{"FindPath", "[", 
              RowBox[{
               RowBox[{"VertexDelete", "[", 
                RowBox[{"graph", ",", 
                 RowBox[{"Complement", "[", 
                  RowBox[{"nodlist", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"nodlist", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"nodlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
                 "]"}], ",", 
               RowBox[{"nodlist", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"nodlist", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"lenshortpaths", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "+", "2"}], ",", "All"}], 
              "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"k", "=", "1"}], ";", 
              RowBox[{"l", "=", "0"}]}], ",", 
             RowBox[{"k", "<=", 
              RowBox[{"Length", "[", 
               RowBox[{"allpaths", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ",", 
             RowBox[{"k", "++"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"IsomorphicGraphQ", "[", 
                RowBox[{
                 RowBox[{"Subgraph", "[", 
                  RowBox[{"graph", ",", 
                   RowBox[{"allpaths", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "k"}], "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{"PathGraph", "[", 
                  RowBox[{"allpaths", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "k"}], "]"}], "]"}], "]"}]}], "]"}], 
               ",", 
               RowBox[{
                RowBox[{"AppendTo", "[", 
                 RowBox[{"validpaths", ",", 
                  RowBox[{"allpaths", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "k"}], "]"}], "]"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"l", "=", 
                 RowBox[{"l", "+", "1"}]}]}]}], "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"numvalidpaths", ",", "l"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"neighlist", ",", 
             RowBox[{"Complement", "[", 
              RowBox[{
               RowBox[{"VertexList", "[", 
                RowBox[{"NeighborhoodGraph", "[", 
                 RowBox[{"graph", ",", 
                  RowBox[{"nodlist", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"nodlist", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "}"}]}], "]"}]}], "]"}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"neighlist", ",", 
             RowBox[{"Complement", "[", 
              RowBox[{
               RowBox[{"VertexList", "[", 
                RowBox[{"NeighborhoodGraph", "[", 
                 RowBox[{"graph", ",", 
                  RowBox[{"nodlist", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}], "]"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"nodlist", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}], "}"}]}], "]"}]}], 
            "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"occ", "=", "2"}], ";", 
        RowBox[{"validpathsx", "=", "validpaths"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"occ", "==", "2"}], ",", 
            RowBox[{
             RowBox[{"Length", "[", "validpathsx", "]"}], ">=", "0"}]}], 
           "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "validpathsx", "]"}], ">", "0"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"testpath", "[", 
                RowBox[{"validpathsx", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "==", "1"}], ",", 
              RowBox[{"occ", "=", "1"}], ",", 
              RowBox[{"validpathsx", "=", 
               RowBox[{"Delete", "[", 
                RowBox[{"validpathsx", ",", "1"}], "]"}]}]}], "]"}], ",", 
            RowBox[{"occ", "=", "0"}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"nodlist", ",", "occ"}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "cases"}], "}"}], ",", 
       RowBox[{"Method", "->", "\"\<CoarsestGrained\>\""}]}], "]"}]}], ";"}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Extract", " ", "the", " ", "node", " ", "sets", " ", "that", " ", 
      "resulted", " ", "in", " ", "occ"}], "=", 
     RowBox[{"1", " ", "for", " ", "the", " ", "second", " ", 
      RowBox[{"scenario", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"six2", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"poss2", ",", 
         RowBox[{"{", 
          RowBox[{"_", ",", "1"}], "}"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Save", " ", "six2", " ", "as", " ", "well"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"SaveToCell", "[", 
    RowBox[{"six2", ",", 
     RowBox[{"Deletable", "->", "False"}]}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"poss4", "=", 
     RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"nodlist", "=", "i"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"i", "=", "1"}], ";", 
           RowBox[{"j", "=", "0"}], ";", 
           RowBox[{"lenshortpaths", "=", 
            RowBox[{"List", "[", "]"}]}], ";", 
           RowBox[{"allpaths", "=", 
            RowBox[{"List", "[", "]"}]}], ";", 
           RowBox[{"neighlist", "=", 
            RowBox[{"List", "[", "]"}]}], ";", 
           RowBox[{"validpaths", "=", 
            RowBox[{"List", "[", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"numvalidpaths", "=", 
            RowBox[{"List", "[", "]"}]}]}], ",", 
          RowBox[{"i", "<=", "3"}], ",", 
          RowBox[{"i", "=", 
           RowBox[{"i", "+", "2"}]}], ",", 
          RowBox[{
           RowBox[{"j", "=", 
            RowBox[{"j", "+", "1"}]}], ";", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"lenshortpaths", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"FindShortestPath", "[", 
               RowBox[{"graph", ",", 
                RowBox[{"nodlist", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{"nodlist", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}], "]"}]}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"allpaths", ",", 
             RowBox[{"FindPath", "[", 
              RowBox[{
               RowBox[{"VertexDelete", "[", 
                RowBox[{"graph", ",", 
                 RowBox[{"Complement", "[", 
                  RowBox[{"nodlist", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"nodlist", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"nodlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
                 "]"}], ",", 
               RowBox[{"nodlist", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"nodlist", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"lenshortpaths", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "+", "4"}], ",", "All"}], 
              "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"k", "=", "1"}], ";", 
              RowBox[{"l", "=", "0"}]}], ",", 
             RowBox[{"k", "<=", 
              RowBox[{"Length", "[", 
               RowBox[{"allpaths", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ",", 
             RowBox[{"k", "++"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"IsomorphicGraphQ", "[", 
                RowBox[{
                 RowBox[{"Subgraph", "[", 
                  RowBox[{"graph", ",", 
                   RowBox[{"allpaths", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "k"}], "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{"PathGraph", "[", 
                  RowBox[{"allpaths", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "k"}], "]"}], "]"}], "]"}]}], "]"}], 
               ",", 
               RowBox[{
                RowBox[{"AppendTo", "[", 
                 RowBox[{"validpaths", ",", 
                  RowBox[{"allpaths", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "k"}], "]"}], "]"}]}], "]"}], ";", 
                RowBox[{"l", "=", 
                 RowBox[{"l", "+", "1"}]}]}]}], "]"}]}], "]"}], ";", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"numvalidpaths", ",", "l"}], "]"}], ";", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"neighlist", ",", 
             RowBox[{"Complement", "[", 
              RowBox[{
               RowBox[{"VertexList", "[", 
                RowBox[{"NeighborhoodGraph", "[", 
                 RowBox[{"graph", ",", 
                  RowBox[{"nodlist", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"nodlist", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "}"}]}], "]"}]}], "]"}], ";", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"neighlist", ",", 
             RowBox[{"Complement", "[", 
              RowBox[{
               RowBox[{"VertexList", "[", 
                RowBox[{"NeighborhoodGraph", "[", 
                 RowBox[{"graph", ",", 
                  RowBox[{"nodlist", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}], "]"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"nodlist", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}], "}"}]}], "]"}]}], 
            "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"occ", "=", "2"}], ";", 
        RowBox[{"validpathsx", "=", "validpaths"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"occ", "==", "2"}], ",", 
            RowBox[{
             RowBox[{"Length", "[", "validpathsx", "]"}], ">=", "0"}]}], 
           "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "validpathsx", "]"}], ">", "0"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"testpath", "[", 
                RowBox[{"validpathsx", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "==", "1"}], ",", 
              RowBox[{
               RowBox[{"occ", "=", "1"}], ";"}], 
              RowBox[{"(*", 
               RowBox[{"Print", "[", "occ", "]"}], "*)"}], ",", 
              RowBox[{"validpathsx", "=", 
               RowBox[{"Delete", "[", 
                RowBox[{"validpathsx", ",", "1"}], "]"}]}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"occ", "=", "0"}], ";"}]}], 
           RowBox[{"(*", 
            RowBox[{"Print", "[", "occ", "]"}], "*)"}], "]"}]}], "]"}], ";", 
        RowBox[{"{", 
         RowBox[{"nodlist", ",", "occ"}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "cases"}], "}"}], ",", 
       RowBox[{"Method", "->", "\"\<CoarsestGrained\>\""}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"six4", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"poss4", ",", 
         RowBox[{"{", 
          RowBox[{"_", ",", "1"}], "}"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"SaveToCell", "[", 
    RowBox[{"six4", ",", 
     RowBox[{"Deletable", "->", "False"}]}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"poss6", "=", 
     RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"nodlist", "=", "i"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"i", "=", "1"}], ";", 
           RowBox[{"j", "=", "0"}], ";", 
           RowBox[{"lenshortpaths", "=", 
            RowBox[{"List", "[", "]"}]}], ";", 
           RowBox[{"allpaths", "=", 
            RowBox[{"List", "[", "]"}]}], ";", 
           RowBox[{"neighlist", "=", 
            RowBox[{"List", "[", "]"}]}], ";", 
           RowBox[{"validpaths", "=", 
            RowBox[{"List", "[", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"numvalidpaths", "=", 
            RowBox[{"List", "[", "]"}]}]}], ",", 
          RowBox[{"i", "<=", "3"}], ",", 
          RowBox[{"i", "=", 
           RowBox[{"i", "+", "2"}]}], ",", 
          RowBox[{
           RowBox[{"j", "=", 
            RowBox[{"j", "+", "1"}]}], ";", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"lenshortpaths", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"FindShortestPath", "[", 
               RowBox[{"graph", ",", 
                RowBox[{"nodlist", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{"nodlist", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}], "]"}]}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"allpaths", ",", 
             RowBox[{"FindPath", "[", 
              RowBox[{
               RowBox[{"VertexDelete", "[", 
                RowBox[{"graph", ",", 
                 RowBox[{"Complement", "[", 
                  RowBox[{"nodlist", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"nodlist", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"nodlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
                 "]"}], ",", 
               RowBox[{"nodlist", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"nodlist", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"lenshortpaths", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "+", "6"}], ",", "All"}], 
              "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"k", "=", "1"}], ";", 
              RowBox[{"l", "=", "0"}]}], ",", 
             RowBox[{"k", "<=", 
              RowBox[{"Length", "[", 
               RowBox[{"allpaths", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ",", 
             RowBox[{"k", "++"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"IsomorphicGraphQ", "[", 
                RowBox[{
                 RowBox[{"Subgraph", "[", 
                  RowBox[{"graph", ",", 
                   RowBox[{"allpaths", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "k"}], "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{"PathGraph", "[", 
                  RowBox[{"allpaths", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "k"}], "]"}], "]"}], "]"}]}], "]"}], 
               ",", 
               RowBox[{
                RowBox[{"AppendTo", "[", 
                 RowBox[{"validpaths", ",", 
                  RowBox[{"allpaths", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "k"}], "]"}], "]"}]}], "]"}], ";", 
                RowBox[{"l", "=", 
                 RowBox[{"l", "+", "1"}]}]}]}], "]"}]}], "]"}], ";", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"numvalidpaths", ",", "l"}], "]"}], ";", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"neighlist", ",", 
             RowBox[{"Complement", "[", 
              RowBox[{
               RowBox[{"VertexList", "[", 
                RowBox[{"NeighborhoodGraph", "[", 
                 RowBox[{"graph", ",", 
                  RowBox[{"nodlist", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"nodlist", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "}"}]}], "]"}]}], "]"}], ";", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"neighlist", ",", 
             RowBox[{"Complement", "[", 
              RowBox[{
               RowBox[{"VertexList", "[", 
                RowBox[{"NeighborhoodGraph", "[", 
                 RowBox[{"graph", ",", 
                  RowBox[{"nodlist", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}], "]"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"nodlist", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}], "}"}]}], "]"}]}], 
            "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"occ", "=", "2"}], ";", 
        RowBox[{"validpathsx", "=", "validpaths"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"occ", "==", "2"}], ",", 
            RowBox[{
             RowBox[{"Length", "[", "validpathsx", "]"}], ">=", "0"}]}], 
           "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "validpathsx", "]"}], ">", "0"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"testpath", "[", 
                RowBox[{"validpathsx", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "==", "1"}], ",", 
              RowBox[{
               RowBox[{"occ", "=", "1"}], ";"}], 
              RowBox[{"(*", 
               RowBox[{"Print", "[", "occ", "]"}], "*)"}], ",", 
              RowBox[{"validpathsx", "=", 
               RowBox[{"Delete", "[", 
                RowBox[{"validpathsx", ",", "1"}], "]"}]}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"occ", "=", "0"}], ";"}]}], 
           RowBox[{"(*", 
            RowBox[{"Print", "[", "occ", "]"}], "*)"}], "]"}]}], "]"}], ";", 
        RowBox[{"{", 
         RowBox[{"nodlist", ",", "occ"}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "cases"}], "}"}], ",", 
       RowBox[{"Method", "->", "\"\<CoarsestGrained\>\""}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"six6", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"poss6", ",", 
         RowBox[{"{", 
          RowBox[{"_", ",", "1"}], "}"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"SaveToCell", "[", 
    RowBox[{"six6", ",", 
     RowBox[{"Deletable", "->", "False"}]}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"poss8", "=", 
     RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"nodlist", "=", "i"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"i", "=", "1"}], ";", 
           RowBox[{"j", "=", "0"}], ";", 
           RowBox[{"lenshortpaths", "=", 
            RowBox[{"List", "[", "]"}]}], ";", 
           RowBox[{"allpaths", "=", 
            RowBox[{"List", "[", "]"}]}], ";", 
           RowBox[{"neighlist", "=", 
            RowBox[{"List", "[", "]"}]}], ";", 
           RowBox[{"validpaths", "=", 
            RowBox[{"List", "[", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"numvalidpaths", "=", 
            RowBox[{"List", "[", "]"}]}]}], ",", 
          RowBox[{"i", "<=", "3"}], ",", 
          RowBox[{"i", "=", 
           RowBox[{"i", "+", "2"}]}], ",", 
          RowBox[{
           RowBox[{"j", "=", 
            RowBox[{"j", "+", "1"}]}], ";", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"lenshortpaths", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"FindShortestPath", "[", 
               RowBox[{"graph", ",", 
                RowBox[{"nodlist", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{"nodlist", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}], "]"}]}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"allpaths", ",", 
             RowBox[{"FindPath", "[", 
              RowBox[{
               RowBox[{"VertexDelete", "[", 
                RowBox[{"graph", ",", 
                 RowBox[{"Complement", "[", 
                  RowBox[{"nodlist", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"nodlist", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"nodlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
                 "]"}], ",", 
               RowBox[{"nodlist", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"nodlist", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"lenshortpaths", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "+", "8"}], ",", "All"}], 
              "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"k", "=", "1"}], ";", 
              RowBox[{"l", "=", "0"}]}], ",", 
             RowBox[{"k", "<=", 
              RowBox[{"Length", "[", 
               RowBox[{"allpaths", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ",", 
             RowBox[{"k", "++"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"IsomorphicGraphQ", "[", 
                RowBox[{
                 RowBox[{"Subgraph", "[", 
                  RowBox[{"graph", ",", 
                   RowBox[{"allpaths", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "k"}], "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{"PathGraph", "[", 
                  RowBox[{"allpaths", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "k"}], "]"}], "]"}], "]"}]}], "]"}], 
               ",", 
               RowBox[{
                RowBox[{"AppendTo", "[", 
                 RowBox[{"validpaths", ",", 
                  RowBox[{"allpaths", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "k"}], "]"}], "]"}]}], "]"}], ";", 
                RowBox[{"l", "=", 
                 RowBox[{"l", "+", "1"}]}]}]}], "]"}]}], "]"}], ";", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"numvalidpaths", ",", "l"}], "]"}], ";", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"neighlist", ",", 
             RowBox[{"Complement", "[", 
              RowBox[{
               RowBox[{"VertexList", "[", 
                RowBox[{"NeighborhoodGraph", "[", 
                 RowBox[{"graph", ",", 
                  RowBox[{"nodlist", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"nodlist", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "}"}]}], "]"}]}], "]"}], ";", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"neighlist", ",", 
             RowBox[{"Complement", "[", 
              RowBox[{
               RowBox[{"VertexList", "[", 
                RowBox[{"NeighborhoodGraph", "[", 
                 RowBox[{"graph", ",", 
                  RowBox[{"nodlist", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}], "]"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"nodlist", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}], "}"}]}], "]"}]}], 
            "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"occ", "=", "2"}], ";", 
        RowBox[{"validpathsx", "=", "validpaths"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"occ", "==", "2"}], ",", 
            RowBox[{
             RowBox[{"Length", "[", "validpathsx", "]"}], ">=", "0"}]}], 
           "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "validpathsx", "]"}], ">", "0"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"testpath", "[", 
                RowBox[{"validpathsx", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "==", "1"}], ",", 
              RowBox[{
               RowBox[{"occ", "=", "1"}], ";"}], 
              RowBox[{"(*", 
               RowBox[{"Print", "[", "occ", "]"}], "*)"}], ",", 
              RowBox[{"validpathsx", "=", 
               RowBox[{"Delete", "[", 
                RowBox[{"validpathsx", ",", "1"}], "]"}]}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"occ", "=", "0"}], ";"}]}], 
           RowBox[{"(*", 
            RowBox[{"Print", "[", "occ", "]"}], "*)"}], "]"}]}], "]"}], ";", 
        RowBox[{"{", 
         RowBox[{"nodlist", ",", "occ"}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "cases"}], "}"}], ",", 
       RowBox[{"Method", "->", "\"\<CoarsestGrained\>\""}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"six8", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"poss8", ",", 
         RowBox[{"{", 
          RowBox[{"_", ",", "1"}], "}"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"SaveToCell", "[", 
    RowBox[{"six8", ",", 
     RowBox[{"Deletable", "->", "False"}]}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"poss10", "=", 
     RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"nodlist", "=", "i"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"i", "=", "1"}], ";", 
           RowBox[{"j", "=", "0"}], ";", 
           RowBox[{"lenshortpaths", "=", 
            RowBox[{"List", "[", "]"}]}], ";", 
           RowBox[{"allpaths", "=", 
            RowBox[{"List", "[", "]"}]}], ";", 
           RowBox[{"neighlist", "=", 
            RowBox[{"List", "[", "]"}]}], ";", 
           RowBox[{"validpaths", "=", 
            RowBox[{"List", "[", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"numvalidpaths", "=", 
            RowBox[{"List", "[", "]"}]}]}], ",", 
          RowBox[{"i", "<=", "3"}], ",", 
          RowBox[{"i", "=", 
           RowBox[{"i", "+", "2"}]}], ",", 
          RowBox[{
           RowBox[{"j", "=", 
            RowBox[{"j", "+", "1"}]}], ";", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"lenshortpaths", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"FindShortestPath", "[", 
               RowBox[{"graph", ",", 
                RowBox[{"nodlist", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{"nodlist", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}], "]"}]}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"allpaths", ",", 
             RowBox[{"FindPath", "[", 
              RowBox[{
               RowBox[{"VertexDelete", "[", 
                RowBox[{"graph", ",", 
                 RowBox[{"Complement", "[", 
                  RowBox[{"nodlist", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"nodlist", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"nodlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
                 "]"}], ",", 
               RowBox[{"nodlist", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"nodlist", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"lenshortpaths", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "+", "10"}], ",", "All"}], 
              "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"k", "=", "1"}], ";", 
              RowBox[{"l", "=", "0"}]}], ",", 
             RowBox[{"k", "<=", 
              RowBox[{"Length", "[", 
               RowBox[{"allpaths", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ",", 
             RowBox[{"k", "++"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"IsomorphicGraphQ", "[", 
                RowBox[{
                 RowBox[{"Subgraph", "[", 
                  RowBox[{"graph", ",", 
                   RowBox[{"allpaths", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "k"}], "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{"PathGraph", "[", 
                  RowBox[{"allpaths", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "k"}], "]"}], "]"}], "]"}]}], "]"}], 
               ",", 
               RowBox[{
                RowBox[{"AppendTo", "[", 
                 RowBox[{"validpaths", ",", 
                  RowBox[{"allpaths", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "k"}], "]"}], "]"}]}], "]"}], ";", 
                RowBox[{"l", "=", 
                 RowBox[{"l", "+", "1"}]}]}]}], "]"}]}], "]"}], ";", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"numvalidpaths", ",", "l"}], "]"}], ";", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"neighlist", ",", 
             RowBox[{"Complement", "[", 
              RowBox[{
               RowBox[{"VertexList", "[", 
                RowBox[{"NeighborhoodGraph", "[", 
                 RowBox[{"graph", ",", 
                  RowBox[{"nodlist", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"nodlist", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "}"}]}], "]"}]}], "]"}], ";", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"neighlist", ",", 
             RowBox[{"Complement", "[", 
              RowBox[{
               RowBox[{"VertexList", "[", 
                RowBox[{"NeighborhoodGraph", "[", 
                 RowBox[{"graph", ",", 
                  RowBox[{"nodlist", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}], "]"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"nodlist", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}], "}"}]}], "]"}]}], 
            "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"occ", "=", "2"}], ";", 
        RowBox[{"validpathsx", "=", "validpaths"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"occ", "==", "2"}], ",", 
            RowBox[{
             RowBox[{"Length", "[", "validpathsx", "]"}], ">=", "0"}]}], 
           "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "validpathsx", "]"}], ">", "0"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"testpath", "[", 
                RowBox[{"validpathsx", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "==", "1"}], ",", 
              RowBox[{
               RowBox[{"occ", "=", "1"}], ";"}], 
              RowBox[{"(*", 
               RowBox[{"Print", "[", "occ", "]"}], "*)"}], ",", 
              RowBox[{"validpathsx", "=", 
               RowBox[{"Delete", "[", 
                RowBox[{"validpathsx", ",", "1"}], "]"}]}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"occ", "=", "0"}], ";"}]}], 
           RowBox[{"(*", 
            RowBox[{"Print", "[", "occ", "]"}], "*)"}], "]"}]}], "]"}], ";", 
        RowBox[{"{", 
         RowBox[{"nodlist", ",", "occ"}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "cases"}], "}"}], ",", 
       RowBox[{"Method", "->", "\"\<CoarsestGrained\>\""}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"six10", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"poss10", ",", 
         RowBox[{"{", 
          RowBox[{"_", ",", "1"}], "}"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"SaveToCell", "[", 
    RowBox[{"six10", ",", 
     RowBox[{"Deletable", "->", "False"}]}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"poss12", "=", 
     RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"nodlist", "=", "i"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"i", "=", "1"}], ";", 
           RowBox[{"j", "=", "0"}], ";", 
           RowBox[{"lenshortpaths", "=", 
            RowBox[{"List", "[", "]"}]}], ";", 
           RowBox[{"allpaths", "=", 
            RowBox[{"List", "[", "]"}]}], ";", 
           RowBox[{"neighlist", "=", 
            RowBox[{"List", "[", "]"}]}], ";", 
           RowBox[{"validpaths", "=", 
            RowBox[{"List", "[", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"numvalidpaths", "=", 
            RowBox[{"List", "[", "]"}]}]}], ",", 
          RowBox[{"i", "<=", "3"}], ",", 
          RowBox[{"i", "=", 
           RowBox[{"i", "+", "2"}]}], ",", 
          RowBox[{
           RowBox[{"j", "=", 
            RowBox[{"j", "+", "1"}]}], ";", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"lenshortpaths", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"FindShortestPath", "[", 
               RowBox[{"graph", ",", 
                RowBox[{"nodlist", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{"nodlist", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}], "]"}]}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"allpaths", ",", 
             RowBox[{"FindPath", "[", 
              RowBox[{
               RowBox[{"VertexDelete", "[", 
                RowBox[{"graph", ",", 
                 RowBox[{"Complement", "[", 
                  RowBox[{"nodlist", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"nodlist", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"nodlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
                 "]"}], ",", 
               RowBox[{"nodlist", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"nodlist", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"lenshortpaths", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "+", "12"}], ",", "All"}], 
              "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"k", "=", "1"}], ";", 
              RowBox[{"l", "=", "0"}]}], ",", 
             RowBox[{"k", "<=", 
              RowBox[{"Length", "[", 
               RowBox[{"allpaths", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ",", 
             RowBox[{"k", "++"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"IsomorphicGraphQ", "[", 
                RowBox[{
                 RowBox[{"Subgraph", "[", 
                  RowBox[{"graph", ",", 
                   RowBox[{"allpaths", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "k"}], "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{"PathGraph", "[", 
                  RowBox[{"allpaths", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "k"}], "]"}], "]"}], "]"}]}], "]"}], 
               ",", 
               RowBox[{
                RowBox[{"AppendTo", "[", 
                 RowBox[{"validpaths", ",", 
                  RowBox[{"allpaths", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "k"}], "]"}], "]"}]}], "]"}], ";", 
                RowBox[{"l", "=", 
                 RowBox[{"l", "+", "1"}]}]}]}], "]"}]}], "]"}], ";", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"numvalidpaths", ",", "l"}], "]"}], ";", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"neighlist", ",", 
             RowBox[{"Complement", "[", 
              RowBox[{
               RowBox[{"VertexList", "[", 
                RowBox[{"NeighborhoodGraph", "[", 
                 RowBox[{"graph", ",", 
                  RowBox[{"nodlist", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"nodlist", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "}"}]}], "]"}]}], "]"}], ";", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"neighlist", ",", 
             RowBox[{"Complement", "[", 
              RowBox[{
               RowBox[{"VertexList", "[", 
                RowBox[{"NeighborhoodGraph", "[", 
                 RowBox[{"graph", ",", 
                  RowBox[{"nodlist", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}], "]"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"nodlist", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}], "}"}]}], "]"}]}], 
            "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"occ", "=", "2"}], ";", 
        RowBox[{"validpathsx", "=", "validpaths"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"occ", "==", "2"}], ",", 
            RowBox[{
             RowBox[{"Length", "[", "validpathsx", "]"}], ">=", "0"}]}], 
           "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "validpathsx", "]"}], ">", "0"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"testpath", "[", 
                RowBox[{"validpathsx", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "==", "1"}], ",", 
              RowBox[{
               RowBox[{"occ", "=", "1"}], ";"}], 
              RowBox[{"(*", 
               RowBox[{"Print", "[", "occ", "]"}], "*)"}], ",", 
              RowBox[{"validpathsx", "=", 
               RowBox[{"Delete", "[", 
                RowBox[{"validpathsx", ",", "1"}], "]"}]}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"occ", "=", "0"}], ";"}]}], 
           RowBox[{"(*", 
            RowBox[{"Print", "[", "occ", "]"}], "*)"}], "]"}]}], "]"}], ";", 
        RowBox[{"{", 
         RowBox[{"nodlist", ",", "occ"}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "cases"}], "}"}], ",", 
       RowBox[{"Method", "->", "\"\<CoarsestGrained\>\""}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"six12", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"poss12", ",", 
         RowBox[{"{", 
          RowBox[{"_", ",", "1"}], "}"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"SaveToCell", "[", 
    RowBox[{"six12", ",", 
     RowBox[{"Deletable", "->", "False"}]}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"poss14", "=", 
     RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"nodlist", "=", "i"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"i", "=", "1"}], ";", 
           RowBox[{"j", "=", "0"}], ";", 
           RowBox[{"lenshortpaths", "=", 
            RowBox[{"List", "[", "]"}]}], ";", 
           RowBox[{"allpaths", "=", 
            RowBox[{"List", "[", "]"}]}], ";", 
           RowBox[{"neighlist", "=", 
            RowBox[{"List", "[", "]"}]}], ";", 
           RowBox[{"validpaths", "=", 
            RowBox[{"List", "[", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"numvalidpaths", "=", 
            RowBox[{"List", "[", "]"}]}]}], ",", 
          RowBox[{"i", "<=", "3"}], ",", 
          RowBox[{"i", "=", 
           RowBox[{"i", "+", "2"}]}], ",", 
          RowBox[{
           RowBox[{"j", "=", 
            RowBox[{"j", "+", "1"}]}], ";", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"lenshortpaths", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"FindShortestPath", "[", 
               RowBox[{"graph", ",", 
                RowBox[{"nodlist", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{"nodlist", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}], "]"}]}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"allpaths", ",", 
             RowBox[{"FindPath", "[", 
              RowBox[{
               RowBox[{"VertexDelete", "[", 
                RowBox[{"graph", ",", 
                 RowBox[{"Complement", "[", 
                  RowBox[{"nodlist", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"nodlist", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"nodlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
                 "]"}], ",", 
               RowBox[{"nodlist", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"nodlist", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"lenshortpaths", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "+", "14"}], ",", "All"}], 
              "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"k", "=", "1"}], ";", 
              RowBox[{"l", "=", "0"}]}], ",", 
             RowBox[{"k", "<=", 
              RowBox[{"Length", "[", 
               RowBox[{"allpaths", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ",", 
             RowBox[{"k", "++"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"IsomorphicGraphQ", "[", 
                RowBox[{
                 RowBox[{"Subgraph", "[", 
                  RowBox[{"graph", ",", 
                   RowBox[{"allpaths", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "k"}], "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{"PathGraph", "[", 
                  RowBox[{"allpaths", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "k"}], "]"}], "]"}], "]"}]}], "]"}], 
               ",", 
               RowBox[{
                RowBox[{"AppendTo", "[", 
                 RowBox[{"validpaths", ",", 
                  RowBox[{"allpaths", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "k"}], "]"}], "]"}]}], "]"}], ";", 
                RowBox[{"l", "=", 
                 RowBox[{"l", "+", "1"}]}]}]}], "]"}]}], "]"}], ";", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"numvalidpaths", ",", "l"}], "]"}], ";", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"neighlist", ",", 
             RowBox[{"Complement", "[", 
              RowBox[{
               RowBox[{"VertexList", "[", 
                RowBox[{"NeighborhoodGraph", "[", 
                 RowBox[{"graph", ",", 
                  RowBox[{"nodlist", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"nodlist", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "}"}]}], "]"}]}], "]"}], ";", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"neighlist", ",", 
             RowBox[{"Complement", "[", 
              RowBox[{
               RowBox[{"VertexList", "[", 
                RowBox[{"NeighborhoodGraph", "[", 
                 RowBox[{"graph", ",", 
                  RowBox[{"nodlist", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}], "]"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"nodlist", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "]"}], "]"}], "}"}]}], "]"}]}], 
            "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"occ", "=", "2"}], ";", 
        RowBox[{"validpathsx", "=", "validpaths"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"occ", "==", "2"}], ",", 
            RowBox[{
             RowBox[{"Length", "[", "validpathsx", "]"}], ">=", "0"}]}], 
           "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "validpathsx", "]"}], ">", "0"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"testpath", "[", 
                RowBox[{"validpathsx", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "==", "1"}], ",", 
              RowBox[{
               RowBox[{"occ", "=", "1"}], ";"}], 
              RowBox[{"(*", 
               RowBox[{"Print", "[", "occ", "]"}], "*)"}], ",", 
              RowBox[{"validpathsx", "=", 
               RowBox[{"Delete", "[", 
                RowBox[{"validpathsx", ",", "1"}], "]"}]}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"occ", "=", "0"}], ";"}]}], 
           RowBox[{"(*", 
            RowBox[{"Print", "[", "occ", "]"}], "*)"}], "]"}]}], "]"}], ";", 
        RowBox[{"{", 
         RowBox[{"nodlist", ",", "occ"}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "cases"}], "}"}], ",", 
       RowBox[{"Method", "->", "\"\<CoarsestGrained\>\""}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"six14", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"poss14", ",", 
         RowBox[{"{", 
          RowBox[{"_", ",", "1"}], "}"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"SaveToCell", "[", 
    RowBox[{"six14", ",", 
     RowBox[{"Deletable", "->", "False"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.895555386095109*^9, 3.895555416469252*^9}, {
   3.895555772886676*^9, 3.895555791786069*^9}, 3.943088509086953*^9, 
   3.9430885392818813`*^9, 
   3.943088611727808*^9},ExpressionUUID->"71dd71f6-822b-4a31-8268-\
b37dc66d201a"]
},
WindowSize->{Full, Full},
WindowMargins->{{331, Automatic}, {Automatic, 50}},
FrontEndVersion->"13.3 for Mac OS X ARM (64-bit) (July 24, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"7d85c7f6-2e80-443b-b86a-0d42ae83174a"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 90820, 2167, 5407, "Input",ExpressionUUID->"71dd71f6-822b-4a31-8268-b37dc66d201a"]
}
]
*)

